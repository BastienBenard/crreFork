<div ng-controller="orderController" class="order-client-validation">
    <div class="row margin-top-20">
        <div class="cell two margin-top-8">
            <div class="search-bar order-search-bar">
                <i class="search padding-5"></i>
                <input class="twelve"
                       type="text"
                       ng-keyup=""
                       i18n-placeholder="search.filter.order">
            </div>
        </div>
        <div class="cell twelve-mobile six catalog">
            <button ng-click=""
                    class="filterButton">
                <i class="school"></i>
                <span><i18n>Teachers</i18n></span>
            </button>
            <button ng-click=""
                    class="filterButton">
                <i class="star-circle"></i>
                <span><i18n>All.type</i18n></span>
            </button>
        </div>
        <div class="cell twelve-mobile right-magnet">
            <button ng-click="" class="validate-order"><i18n>crre.take.order.2</i18n></button>
        </div>
    </div>
    <div class="flex-row">
        <table class="twelve-mobile ten">
            <thead>
            <tr>
                <td workflow="crre.validator" class="table-selector main-selector">
                    <label class="checkbox">
                        <input type="checkbox"
                               ng-change="switchAllOrders()"
                               ng-model="allOrdersSelected">
                        <span></span>
                    </label>
                </td>
                <!--                <td ng-repeat="field in tableFields "-->
                <!--                    ng-hide="!field.display"-->
                <!--                    ng-click="sort.order.type = field.fieldName; sort.order.reverse = !sort.order.reverse">-->
                <!--                    <div class="smallTabElem">  [[lang.translate(field.name)]] </div>-->
                <!--                    <i class="up-open" ng-show="sort.order.type === field.fieldName && !sort.order.reverse"></i>-->
                <!--                    <i class="down-open" ng-show="sort.order.type === field.fieldName && sort.order.reverse"></i>-->
                <!--                </td>-->
                <td><div class="smallTabElem center"><i18n>crre.equipment.date</i18n></div></td>
                <td><div class="smallTabElem"><i18n>crre.basket</i18n></div></td>
                <td><div class="smallTabElem"><i18n>Owner</i18n></div></td>
                <td><div class="smallTabElem center"><i18n>crre.quantity</i18n></div></td>
                <td><div class="smallTabElem center"><i18n>Total</i18n></div></td>
                <td><div class="smallTabElem"><i18n>comment</i18n></div></td>
            </tr>
            </thead>
            <tbody ng-repeat="basket in displayedBasketsOrders | orderBy:sort.order.type:sort.order.reverse">
                <tr class="line">
                    <td workflow="crre.validator" class="table-selector">
                        <label class="checkbox">
                            <input type="checkbox" ng-model="basket.selected" ng-change="switchAllSublines(basket)">
                            <span></span>
                        </label>
                    </td>
                    <td ng-click="basket.expanded=!basket.expanded"><div class="smallTabElem center">[[basket.created]]</div></td>
                    <td ng-click="basket.expanded=!basket.expanded"><div class="tabElem order">[[basket.name]]</div></td>
                    <td ng-click="basket.expanded=!basket.expanded"><div class="tabElem">[[basket.name_user]]</div></td>
                    <td ng-click="basket.expanded=!basket.expanded"><div class="smallTabElem center"> [[basket.amount]]</div></td>
                    <td ng-click="basket.expanded=!basket.expanded"><div class="smallTabElem center">[[basket.total]]</div></td>
                    <td ng-click="basket.expanded=!basket.expanded"><div class="tabElem"></div></td>
                </tr>
                <tr ng-repeat="order in basket.orders | orderBy:sort.order.type:sort.order.reverse"
                    ng-if="basket.expanded" class="subline" post-ng-repeat>
                <td workflow="crre.validator" class="table-selector">
                    <label class="checkbox">
                        <input type="checkbox" ng-model="order.selected" ng-change="checkParentSwitch(basket, order.selected)">
                        <span></span>
                    </label>
                </td>
                <td ng-if="tableFields[0].display"><div class="smallTabElem"></div></td>
                <td ng-if="tableFields[1].display"><div class="tabElem order">
                    <img src="[[order.image]]"/><div>[[order.name]]</div>
                </div></td>
                <td ng-if="tableFields[2].display"><div class="tabElem"></div></td>
                <td ng-if="tableFields[3].display"><div class="smallTabElem center"> [[order.amount]]</div></td>
                <td ng-if="tableFields[4].display"><div class="smallTabElem center"><span ng-bind="order.priceTotalTTC | currency"></span></div></td>
                <td ng-if="tableFields[5].display">
                    <div ng-init="tableFields[6].fullDisplay = false"
                        class="tabElem"
                        ng-class="{ellipsis:!tableFields[6].fullDisplay}"
                        ng-click="tableFields[6].fullDisplay = !tableFields[6].fullDisplay"> [[order.comment || '-']]</div>
                </td>
            </tr>
            </tbody>
            <tfoot>
            <tr>
                <td colspan="4">
                    <i18n class="center">totals</i18n>
                </td>
                <td ng-if="tableFields[3].display" colspan="[[countColSpan('price') - 1]]"> <div class="smallTabElem center">[[displayedOrders.calculTotalAmount()]]</div></td>
                <td ng-if="tableFields[4].display" >
                    <div class="smallTabElem center"> [[displayedOrders.calculTotalPriceTTC() | currency]]</div>
                </td>
                <td></td>
            </tr>
            </tfoot>
        </table>
        <div class="twelve-mobile tot-cards center two">
            <h2><i18n>total.request</i18n></h2>
            <div>
                Total : <span ng-bind="getTotal()"></span>
            </div>
            <div>
                Initial : <span ng-bind="campaign.purse_amount"></span>
            </div>
            <div>
                Reste : <span ng-bind="campaign.purse_amount - getTotal()"></span>
            </div>
        </div>
    </div>
    <lightbox on-close="closedLighbtox();"
              show="display.lightbox.validOrder">
        <container template="validOrder.lightbox"></container>
    </lightbox>
    <section class="toggle-buttons" ng-class="{ hide: ordersClient.selected.length === 0 }">
        <div class="toggle">
            <div class="row">
                <button ng-click="">
                    <i18n>Denied</i18n>
                </button>
                <button ng-click="exportCSV()" >
                    <i18n>crre.logs.csv.export</i18n>
                </button>
            </div>
        </div>
    </section>
</div>

