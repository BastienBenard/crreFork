<div class="loading-bar" ng-class="{loading: equipment.loading}"></div>

<div ng-if="equipment.loading">
    <h1><i18n>crre.loading</i18n></h1>
</div>

<div ng-if="!equipment.loading" class="row ten centered">
    <h1>
        <i18n ng-show="equipment.id == undefined">crre.equipment.add</i18n>
        <i18n ng-show="equipment.id !== undefined">crre.equipment.modify</i18n>
    </h1>

    <article>
        <form >
            <div class="row horizontal-spacing vertical-spacing">
                <div class="cell four horizontal-spacing twelve-mobile">
                    <div class="eight row centered">
                        <image-select ng-model="equipment.image"
                                      visibility="'public'"
                                      default="/img/illustrations/image-default.svg">
                        </image-select>
                    </div>
                </div>
                <div class="eight cell horizontal-spacing twelve-mobile">
                    <h2><i18n>crre.information</i18n></h2>
                    <label class="row twelve vertical-spacing">
                        <span class="twelve">
                            <i18n>crre.equipment.name</i18n> *
                        </span>
                        <input type="text" class="twelve" ng-model="equipment.name" required>
                    </label>
                    <label class="row twelve vertical-spacing">
                        <span class="twelve">
                            <i18n>crre.equipment.reference</i18n>[[equipment.id? " *" : ""]]
                        </span>
                        <input type="text" class="twelve" ng-model="equipment.reference">
                    </label>
                    <label class="row twelve vertical-spacing">
                        <span class="twelve">
                            <i18n>crre.equipment.summary</i18n>
                            <em class="smaller-text"><i18n>crre.equipment.summary.length</i18n></em>
                        </span>
                        <textarea ng-model="equipment.summary"
                                  cols="20"
                                  rows="10"
                                  maxlength="300"
                        >
                        </textarea>
                    </label>
                    <label class="five twelve-mobile vertical-spacing cell">
                        <span class="four cell twelve-mobile">
                            <i18n>crre.tax</i18n> *
                        </span>
                        <span class="eight cell twelve-mobile">
                            <select
                                    ng-model="equipment.id_tax"
                                    class="eleven"
                                    ng-init="equipment.id_tax = equipment.id_tax || (taxes.all.length > 0 ? taxes.all[0].id : null)"
                                    ng-options="tax.id as tax.value + '%' for tax in taxes.all"
                                    required
                            >
                            </select>
                        </span>
                    </label>
                    <label class="five twelve-mobile vertical-spacing cell">
                        <span class="four cell twelve-mobile">
                            <i18n>crre.price</i18n> *
                        </span>
                        <span class="eight cell twelve-mobile">
                            <input type="number" step="0.01" class="eleven" ng-model="equipment.price" required>
                        </span>
                    </label>
                </div>
            </div>
            <div class="row twelve">
                <label class="row twelve vertical-spacing">
                        <span class="twelve">
                            <i18n>crre.equipment.description</i18n>
                        </span>
                    <editor ng-model="equipment.description"></editor>
                </label>
            </div>
            <div class="row twelve">
                <h2 class="vertical-spacing">
                    <i18n>crre.equipment.technical.specifications</i18n>
                </h2>
                <div class="row technical-specs">
                    <div class="twelve row">
                        <div class="technical-spec twelve row"
                             ng-repeat="technicalSpec in equipment.technical_specs">
                            <div class="five cell horizontal-spacing">
                                <input
                                        type="text"
                                        class="twelve"
                                        ng-model="technicalSpec.name"
                                >
                            </div>
                            <div class="six cell horizontal-spacing">
                                <input
                                        type="text"
                                        class="twelve"
                                        ng-model="technicalSpec.value"
                                >
                            </div>
                            <div class="one cell">
                                <i class="trash"
                                   ng-click="dropTechnicalSpec(equipment, technicalSpec)">

                                </i>
                            </div>
                        </div>
                    </div>
                    <div class="row vertical-spacing">
                        <div class="right-magnet horizontal-spacing">
                            <input type="button" ng-click="addTechnicalSpec(equipment)" class="cancel" i18n-value="add">
                        </div>
                    </div>
                </div>
            </div>
            <div class="row twelve">
                <h2>
                    <i18n>crre.equipment.administration</i18n>
                </h2>
<!--                <div class="row">
                    <h4 class="two cell twelve-mobile vertical-spacing"><i18n>crre.equipment.contract</i18n> *</h4>
                    <div class="nine cell twelve-mobile vertical-spacing">
                        <select
                                class="six twelve-mobile"
                                ng-model="equipment.id_contract"
                                required
                                ng-options="contract.id as (contract.name + ' - Ref ' + contract.reference) for contract in contracts.all"
                        >
                        </select>
                    </div>
                </div>-->
                <div class="row vertical-spacing">
                    <h4 class="two cell twelve-mobile">
                        <i18n>crre.availability</i18n>
                    </h4>
                    <div class="cell twelve-mobile ten">
                        <div class="row seven twelve-mobile" ng-init="equipment.status = equipment.status || 'AVAILABLE'">
                            <label class="horizontal-spacing twelve-mobile row-mobile">
                                <span class="horizontal-spacing six-mobile cell">
                                    <i18n>crre.AVAILABLE</i18n>
                                </span>
                                <input type="radio" class="cell"
                                       ng-model="equipment.status"
                                       value="AVAILABLE"
                                />
                            </label>
                            <label class="horizontal-spacing twelve-mobile row-mobile">
                                <span class="horizontal-spacing six-mobile cell">
                                    <i18n>crre.OUT_OF_STOCK</i18n>
                                </span>
                                <input type="radio" class="cell"
                                       ng-model="equipment.status"
                                       value="OUT_OF_STOCK"
                                />
                            </label>
                            <label class="horizontal-spacing twelve-mobile row-mobile">
                                <span class="horizontal-spacing six-mobile cell">
                                    <i18n>crre.UNAVAILABLE</i18n>
                                </span>
                                <input
                                        type="radio"
                                        class="cell"
                                        ng-model="equipment.status"
                                        value="UNAVAILABLE"
                                />
                            </label>
                        </div>
                        <div class="row seven twelve-mobile">
                            <label class="vertical-spacing twelve-mobile row-mobile">
                                <span class="horizontal-spacing six-mobile cell three">
                                    <i18n>crre.AVAILABLE_ON_THE_CATALOG</i18n>
                                </span>
                                <switch-toggle ng-model="equipment.catalog_enabled"
                                               class="cell"></switch-toggle>
                            </label>
                            <div class="row seven twelve-mobile">
                                <label class="vertical-spacing twelve-mobile row-mobile">
                                <span class="horizontal-spacing six-mobile cell three">
                                    <i18n>crre.AVAILABLE_AS_AN_OPTION</i18n>
                                </span>
                                    <switch-toggle
                                            ng-model="equipment.option_enabled"
                                            class="cell">
                                    </switch-toggle>
                                </label>
                            </div>
                            <div class="row seven twelve-mobile">
                                <label class="vertical-spacing twelve-mobile row-mobile">
                                <span class="horizontal-spacing six-mobile cell three">
                                    <i18n>crre.contract.price_editable</i18n>
                                </span>
                                    <switch-toggle ng-model="equipment.price_editable"></switch-toggle>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="right-magnet">
                    <input
                            type="button"
                            class="cancel"
                            ng-click="redirectTo('/equipments')"
                            i18n-value="cancel"
                    />
                    <input
                            type="submit"
                            class="button"
                            ng-click="validEquipment(equipment)"
                            ng-disabled="!validEquipmentForm(equipment)"
                    />
                </div>
            </div>
        </form>
    </article>
</div>